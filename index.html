<!doctype html>
<html lang="zh-Hant-TW">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>æ±äº¬Ã—å¯Œå£«Ã—ä»™å° è¡Œç¨‹è¡¨</title>
  <style>
    :root{
      --bg:#0b0f17;
      --card:#101827;
      --card2:#0e1523;
      --text:#e9eef7;
      --muted:#a9b4c7;
      --line:#21304a;
      --accent:#7c5cff;
      --accent2:#2de2e6;
      --good:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --shadow: 0 12px 30px rgba(0,0,0,.35);
      --radius: 18px;

      /* âœ… èƒŒæ™¯åº•åœ–ï¼šè¦æ›åœ–å°±æ”¹é€™è¡Œ URL */
      --bg-img: url("https://res.klook.com/image/upload/activities/dou1pmzm3f41p75jkox9.jpg");
    }
    [data-theme="light"]{
      --bg:#f6f8ff;
      --card:#ffffff;
      --card2:#f3f6ff;
      --text:#0b1020;
      --muted:#58637a;
      --line:#d8e0f2;
      --accent:#5b5cff;
      --accent2:#00b3c6;
      --shadow: 0 14px 30px rgba(25,35,60,.10);
    }
    *{box-sizing:border-box}

    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", "Noto Sans TC", "PingFang TC", "Microsoft JhengHei", sans-serif;
      background:
        linear-gradient(180deg, rgba(11,15,23,.76), rgba(11,15,23,.88)),
        radial-gradient(1200px 800px at 20% -10%, rgba(124,92,255,.35), transparent 55%),
        radial-gradient(900px 700px at 90% 10%, rgba(45,226,230,.25), transparent 55%),
        var(--bg-img),
        var(--bg);
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      color:var(--text);
      min-height:100vh;
    }
    [data-theme="light"] body{
      background:
        linear-gradient(180deg, rgba(246,248,255,.76), rgba(246,248,255,.88)),
        radial-gradient(1200px 800px at 20% -10%, rgba(124,92,255,.16), transparent 55%),
        radial-gradient(900px 700px at 90% 10%, rgba(45,226,230,.12), transparent 55%),
        var(--bg-img),
        var(--bg);
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
    }

    a{color:inherit}
    .wrap{
      max-width:1100px;
      margin:0 auto;
      padding:28px 18px 60px;
    }
    header{
      display:flex;
      gap:14px;
      align-items:flex-start;
      justify-content:space-between;
      flex-wrap:wrap;
      margin-bottom:18px;
    }
    .title{
      display:flex; flex-direction:column; gap:8px;
      max-width:720px;
    }
    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:7px 12px;
      background: linear-gradient(90deg, rgba(124,92,255,.18), rgba(45,226,230,.12));
      border:1px solid rgba(124,92,255,.25);
      border-radius:999px;
      color:var(--text);
      width:fit-content;
      box-shadow:0 10px 24px rgba(124,92,255,.10);
      backdrop-filter: blur(8px);
    }
    .badge .dot{
      width:10px; height:10px; border-radius:50%;
      background: linear-gradient(180deg, var(--accent), var(--accent2));
      box-shadow:0 0 0 6px rgba(124,92,255,.16);
    }
    h1{
      margin:0;
      font-size:clamp(22px, 3.2vw, 34px);
      letter-spacing:.2px;
      line-height:1.2;
    }
    .sub{
      margin:0;
      color:var(--muted);
      line-height:1.6;
      font-size:14.5px;
    }
    .controls{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      justify-content:flex-end;
    }
    .btn{
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.04));
      color:var(--text);
      padding:10px 12px;
      border-radius:12px;
      cursor:pointer;
      transition:.18s ease;
      box-shadow: 0 8px 18px rgba(0,0,0,.12);
      user-select:none;
      backdrop-filter: blur(10px);
    }
    [data-theme="light"] .btn{
      background: linear-gradient(180deg, rgba(10,15,30,.06), rgba(10,15,30,.02));
      box-shadow: 0 10px 18px rgba(25,35,60,.08);
    }
    .btn:hover{transform: translateY(-1px); border-color: rgba(124,92,255,.55)}
    .btn:active{transform: translateY(0px)}
    .btn.primary{
      border:1px solid rgba(124,92,255,.55);
      background: linear-gradient(90deg, rgba(124,92,255,.22), rgba(45,226,230,.12));
    }
    .pill{
      display:flex;
      gap:8px;
      align-items:center;
      padding:10px 12px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.06);
      border-radius:12px;
      backdrop-filter: blur(10px);
    }
    input[type="search"]{
      width:min(360px, 72vw);
      border:none;
      outline:none;
      background:transparent;
      color:var(--text);
      font-size:14px;
    }
    .select{
      border:none;
      outline:none;
      background:transparent;
      color:var(--text);
      font-size:14px;
      cursor:pointer;
    }
    .select option{color:#111}
    .panel{
      margin:16px 0 22px;
      padding:14px 14px 12px;
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.04));
      border-radius:var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
    }
    .progressRow{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:14px;
      flex-wrap:wrap;
    }
    .bar{
      flex:1;
      height:12px;
      border-radius:999px;
      background: rgba(255,255,255,.10);
      border:1px solid var(--line);
      overflow:hidden;
      min-width: 220px;
    }
    .bar > div{
      height:100%;
      width:0%;
      border-radius:999px;
      background: linear-gradient(90deg, var(--accent), var(--accent2));
      transition: width .25s ease;
    }
    .kpi{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      color:var(--muted);
      font-size:13.5px;
    }
    .kpi strong{color:var(--text)}
    .grid{
      display:grid;
      grid-template-columns: 1fr;
      gap:14px;
    }
    @media (min-width: 920px){
      .grid{grid-template-columns: 1fr 1fr}
    }

    .dayCard{
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(16,24,39,.82), rgba(255,255,255,.02));
      border-radius:var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
      backdrop-filter: blur(10px);
      transition: .18s ease;
    }
    [data-theme="light"] .dayCard{
      background: linear-gradient(180deg, rgba(255,255,255,.88), rgba(255,255,255,.62));
    }

    /* âœ… åªè¦åŒä¸€å¤©å…¨éƒ¨éƒ½å‹¾å®Œï¼šæ•´å¼µæ›´äº® + å¤–æ¡†å®Œæˆè‰² */
    .dayCard[data-done="true"]{
      border-color: rgba(52,211,153,.70);
      background: linear-gradient(180deg, rgba(52,211,153,.16), rgba(255,255,255,.02));
      box-shadow: 0 18px 56px rgba(52,211,153,.12), var(--shadow);
    }
    [data-theme="light"] .dayCard[data-done="true"]{
      background: linear-gradient(180deg, rgba(52,211,153,.14), rgba(255,255,255,.72));
      box-shadow: 0 18px 56px rgba(52,211,153,.10), var(--shadow);
    }
    .dayCard[data-done="true"] .dayHead{
      background: linear-gradient(180deg, rgba(52,211,153,.14), transparent 70%);
    }

    .dayHead{
      padding:14px 14px 12px;
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      cursor:pointer;
      user-select:none;
    }
    .dayHead:hover{
      background: linear-gradient(180deg, rgba(124,92,255,.10), transparent 65%);
    }
    .dayTitle{
      display:flex;
      flex-direction:column;
      gap:6px;
      min-width: 0;
    }
    .dayTitle .date{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
    }
    .tag{
      font-size:12px;
      padding:4px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      color:var(--muted);
      background: rgba(255,255,255,.06);
    }
    .tag.hotel{border-color:rgba(45,226,230,.35)}
    .tag.drive{border-color:rgba(124,92,255,.45)}
    .tag.food{border-color:rgba(251,191,36,.45)}
    .tag.shrine{border-color:rgba(52,211,153,.45)}
    .tag.transit{border-color:rgba(251,113,133,.40)}
    .dayTitle h2{
      margin:0;
      font-size:18px;
      line-height:1.25;
      letter-spacing:.2px;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
      max-width: 560px;
    }
    .dayTitle p{
      margin:0;
      color:var(--muted);
      font-size:13.5px;
      line-height:1.45;
    }
    .chev{
      width:42px; height:42px;
      border-radius:12px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.06);
      display:grid;
      place-items:center;
      flex:0 0 auto;
      transition:.18s ease;
    }
    .dayCard[data-open="true"] .chev{transform: rotate(180deg); border-color: rgba(124,92,255,.55)}
    .dayBody{
      padding:0 14px 14px;
      display:none;
    }
    .dayCard[data-open="true"] .dayBody{display:block}
    .items{
      display:flex;
      flex-direction:column;
      gap:10px;
      margin-top:12px;
    }
    .item{
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
      border-radius:14px;
      padding:10px 10px;
      display:flex;
      gap:10px;
      align-items:flex-start;
    }
    .time{
      font-variant-numeric: tabular-nums;
      flex:0 0 auto;
      min-width: 56px;
      padding:6px 8px;
      border-radius:12px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.06);
      color:var(--text);
      font-size:13px;
      text-align:center;
    }
    .main{
      flex:1;
      min-width: 0;
      display:flex;
      flex-direction:column;
      gap:4px;
    }
    .main .what{
      font-size:14.5px;
      line-height:1.35;
      margin:0;
    }
    .main .note{
      margin:0;
      color:var(--muted);
      font-size:13px;
      line-height:1.45;
    }
    .actions{
      display:flex;
      flex-direction:column;
      gap:8px;
      align-items:flex-end;
      flex:0 0 auto;
    }
    .mini{
      border:1px solid var(--line);
      background: rgba(255,255,255,.06);
      color:var(--text);
      padding:7px 10px;
      border-radius:12px;
      cursor:pointer;
      font-size:12.5px;
      transition:.15s ease;
      backdrop-filter: blur(8px);
    }
    .mini:hover{transform: translateY(-1px); border-color: rgba(45,226,230,.55)}
    .check{
      display:flex;
      align-items:center;
      gap:8px;
      user-select:none;
      cursor:pointer;
      color:var(--muted);
      font-size:12.5px;
    }
    .check input{width:18px; height:18px}
    .item.done{
      border-color: rgba(52,211,153,.55);
      background: linear-gradient(180deg, rgba(52,211,153,.12), rgba(255,255,255,.02));
    }
    .item.done .what{ text-decoration: line-through; color: rgba(233,238,247,.75) }
    [data-theme="light"] .item.done .what{ color: rgba(11,16,32,.65) }

    .footerHint{
      margin-top:18px;
      color:var(--muted);
      font-size:12.5px;
      line-height:1.6;
    }

    .toast{
      position:fixed;
      left:50%;
      bottom:18px;
      transform: translateX(-50%);
      background: rgba(10,12,18,.88);
      border:1px solid rgba(124,92,255,.35);
      color:#fff;
      padding:10px 12px;
      border-radius:14px;
      box-shadow: 0 16px 40px rgba(0,0,0,.35);
      opacity:0;
      pointer-events:none;
      transition:.2s ease;
      max-width: 92vw;
      font-size:13px;
      backdrop-filter: blur(10px);
    }
    [data-theme="light"] .toast{background: rgba(255,255,255,.92); color:#0b1020; border-color: rgba(124,92,255,.28)}
    .toast.show{opacity:1; transform: translateX(-50%) translateY(-6px)}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="title">
        <div class="badge"><span class="dot"></span> 2026/02/20â€“03/01ï½œæ±äº¬ Ã— å¯Œå£«æ²³å£æ¹– Ã— ä»™å°</div>
        <h1>æ—…éŠè¡Œç¨‹è¡¨</h1>
        <p class="sub">å¯å‹¾é¸å®Œæˆã€æœå°‹åº—ååœ°é»ã€å¿«é€Ÿé–‹åœ°åœ–ã€‚ä½ çš„å‹¾é¸ç‹€æ…‹æœƒè‡ªå‹•ä¿å­˜ã€‚</p>
      </div>

      <div class="controls">
        <div class="pill" title="æœå°‹ï¼šåº—å / ç¥ç¤¾ / å¯Œå£«å±± / ç‰›èˆŒ ç­‰">
          ğŸ” <input id="q" type="search" placeholder="æœå°‹é—œéµå­—ï¼ˆä¾‹å¦‚ï¼šç‰›èˆŒ / æ·ºè‰ / è—ç‹ï¼‰" />
        </div>

        <div class="pill" title="ç¯©é¸é¡å‹">
          ğŸ§©
          <select id="filter" class="select">
            <option value="all">å…¨éƒ¨</option>
            <option value="todo">åªçœ‹æœªå®Œæˆ</option>
            <option value="food">é¤å»³/ç”œé»</option>
            <option value="shrine">ç¥ç¤¾/å¯ºé™¢</option>
            <option value="hotel">ä½å®¿</option>
            <option value="transit">äº¤é€š/ç§Ÿè»Š</option>
            <option value="spot">æ™¯é»/æ‹ç…§</option>
            <option value="shop">è³¼ç‰©</option>
          </select>
        </div>

        <button id="toggleTheme" class="btn">ğŸŒ— æ·±è‰²/æ·ºè‰²</button>
        <button id="expandAll" class="btn primary">ğŸ§¾ å…¨éƒ¨å±•é–‹</button>
        <button id="reset" class="btn" title="æ¸…é™¤æ‰€æœ‰å‹¾é¸ï¼ˆä¸å¯å¾©åŸï¼‰">ğŸ§¼ æ¸…ç©ºå‹¾é¸</button>
      </div>
    </header>

    <section class="panel">
      <div class="progressRow">
        <div class="kpi">
          <span>å®Œæˆé€²åº¦ï¼š<strong id="doneText">0</strong></span>
          <span>ï½œç¸½è¡Œç¨‹ï¼š<strong id="totalText">0</strong></span>
          <span>ï½œå®Œæˆç‡ï¼š<strong id="pctText">0%</strong></span>
        </div>
        <div class="bar" aria-label="é€²åº¦æ¢"><div id="barFill"></div></div>
      </div>
    </section>

    <main id="grid" class="grid"></main>

    <p class="footerHint">
      å°æç¤ºï¼šæ¯å€‹è¡Œç¨‹å³å´éƒ½æœ‰ã€Œåœ°åœ–ã€æŒ‰éˆ•æœƒç›´æ¥ç”¨ Google åœ°åœ–æœå°‹è©²åœ°é»ï¼›å‹¾é¸å®Œæˆå¾Œæœƒè‡ªå‹•è¨˜ä½ï¼ˆä¿å­˜åœ¨ç€è¦½å™¨ï¼‰ã€‚
    </p>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

<script>
  const itinerary = [
    {
      id: "2026-02-20",
      dateLabel: "2/20ï¼ˆäº”ï¼‰",
      title: "æŠµé”æ±äº¬ï¼šåšåˆ‡ç‰›èˆŒä¹‹å¤œ",
      subtitle: "ä¸Šé‡å…¥ä½ â†’ ç‰›èˆŒåƒåˆ°é£½",
      tags: ["hotel","food"],
      items: [
        { time:"17:00", type:"hotel", title:"æŠµé”ä¸¦å…¥ä½ Ueno First City Hotel", note:"æ”¾è¡Œæã€ç¨ä½œä¼‘æ¯ï¼Œæ™šä¸Šç›´æ¥é€²æ”»ç‰›èˆŒã€‚", place:"Ueno First City Hotel" },
        { time:"19:00", type:"food",  title:"æ™šé¤ï¼šç„¼è‚‰ä¸€å¿ƒãŸã‚“åŠ© ä¸Šé‡æœ¬åº—ï¼ˆåšåˆ‡ç‰›èˆŒåƒåˆ°é£½ï¼‰", note:"å»ºè­°ææ—©åˆ°æˆ–å…ˆç¢ºèªå€™ä½æ–¹å¼ã€‚", place:"ç„¼è‚‰ä¸€å¿ƒãŸã‚“åŠ© ä¸Šé‡æœ¬åº—" },
      ]
    },
    {
      id: "2026-02-21",
      dateLabel: "2/21ï¼ˆå…­ï¼‰",
      title: "ç¥ç¤¾å·¡ç¦®èˆ‡éŠ€åº§ç¾é£Ÿ",
      subtitle: "ä¸Šé‡ç¥ç¤¾ â†’ éŠ€åº§æ‹‰éºµç”œé» â†’ æ·ºè‰é›·é–€",
      tags: ["shrine","food"],
      items: [
        { time:"09:00", type:"shrine", title:"åƒæ‹œï¼šå°é‡ç…§å´ç¥ç¤¾", note:"æ—©ä¸Šäººå°‘å¥½æ‹ç…§ï¼Œæ­¥èª¿èˆ’æœã€‚", place:"å°é‡ç…§å´ç¥ç¤¾" },
        { time:"09:40", type:"shrine", title:"åƒæ‹œï¼šå¦™ç¾©ç¥ç¤¾", note:"é †è·¯è£œä¸€åº§ç¥ç¤¾ï¼Œæ‹å€‹å¾¡æœ±å°/é³¥å±…æ„Ÿã€‚", place:"å¦™ç¾©ç¥ç¤¾" },
        { time:"11:00", type:"food", title:"æ—©é¤/æ—©åˆé¤ï¼šDepot", note:"å¸ƒä¸ï¼†çƒ¤åœŸå¸äººæ°£é«˜ï¼Œæ—©é»åˆ°æ›´ç©©ã€‚", place:"Depot" },
        { time:"12:30", type:"food", title:"åˆé¤ï¼šéŠ€åº§å…«äº”ï¼ˆäººæ°£æ‹‰éºµï¼‰", note:"å»ºè­°ææ—©æ’éšŠï¼Œåƒå®Œå†æ•£æ­¥ç”œé»ã€‚", place:"éŠ€åº§ å…«äº”" },
        { time:"14:30", type:"food", title:"ç”œé»ï¼šFrÃ©dÃ©ric Cassel", note:"è£œç³–è£œèƒ½é‡ï¼ŒéŠ€åº§é€›è¡—ä¹Ÿé †è·¯ã€‚", place:"FrÃ©dÃ©ric Cassel Ginza Mitsukoshi Store" },
        { time:"16:00", type:"shrine", title:"åƒæ‹œï¼šä»Šæˆ¶ç¥ç¤¾", note:"æ‹›è²¡è²“ï¼‹æˆ€æ„›èƒ½é‡é»ï¼Œå…ˆä¾†é€™è£¡æ‹ç…§æ›´èˆ’æœã€‚", place:"ä»Šæˆ¶ç¥ç¤¾" },
        { time:"16:40", type:"spot",   title:"æ·ºè‰å¯ºãƒ»é›·é–€", note:"æ‹é›·é–€ã€é€›ä»²è¦‹ä¸–ï¼Œå‚æ™šç‡ˆå…‰å¾ˆç¾ã€‚", place:"æµ…è‰å¯º é›·é–€" },
        { time:"17:30", type:"food", title:"é»å¿ƒï¼šKURAMAE CANNELE", note:"å¯éº—éœ²å¤–è„†å…§Qï¼Œè²·äº†é‚Šèµ°é‚Šåƒã€‚", place:"KURAMAE CANNELE" },
        { time:"â€”", type:"hotel", title:"ä½å®¿ï¼šUeno First City Hotel", note:"å›ä¸Šé‡ä¼‘æ¯ï¼Œéš”å¤©è¦è‡ªé§•æ—©èµ·ã€‚", place:"Ueno First City Hotel" },
      ]
    },
    {
      id: "2026-02-22",
      dateLabel: "2/22ï¼ˆæ—¥ï¼‰",
      title: "è‡ªé§•å‰å¾€å¯Œå£«æ²³å£æ¹–",
      subtitle: "ä¸Šé‡å–è»Š â†’ å¯Œå£«å±±æ‹ç…§é» â†’ æ²³å£æ¹–å…¥ä½",
      tags: ["transit","spot","hotel","food"],
      items: [
        { time:"08:00", type:"transit", title:"è±ç”°ç§Ÿè»Šï¼šä¸Šé‡é§…å‰å–è»Š", note:"å‡ºç™¼å‰ç¢ºèª ETCï¼ä¿éšªï¼å°èˆªèªè¨€ã€‚", place:"Toyota Rent a Car ä¸Šé‡é§…å‰" },
        { time:"10:30", type:"spot", title:"æ—¥å·æ™‚è¨ˆåº—ï¼ˆå¯Œå£«å±±è¡—æ™¯æ‹æ”é»ï¼‰", note:"ç¶“å…¸æ§‹åœ–ï¼šè¡—é“å»¶ä¼¸ï¼‹å¯Œå£«å±±ã€‚", place:"æ—¥å·æ™‚è¨ˆåº—" },
        { time:"12:00", type:"spot", title:"æ–°å€‰å±±æ·ºé–“å…¬åœ’", note:"éšæ¢¯ï¼‹äº”é‡å¡”ï¼‹å¯Œå£«å±±ï¼Œé«”åŠ›è¦ç•™ã€‚", place:"æ–°å€‰å±±æµ…é–“å…¬åœ’" },
        { time:"14:30", type:"spot", title:"å¯Œå£«å±±é™æ‹æ‰€", note:"è¦–é‡é–‹é—Šã€é©åˆæ‹å¤§æ™¯ã€‚", place:"å¯Œå£«å±± é™æ‹æ‰€" },
        { time:"18:30", type:"food", title:"æ™šé¤ï¼šTorikko", note:"å›åˆ°æ²³å£æ¹–å€åŸŸæ…¢æ…¢åƒã€‚", place:"Torikko" },
        { time:"â€”", type:"hotel", title:"ä½å®¿ï¼šTHE NOBORISAKA HOTEL", note:"éš”å¤©æ¸…æ™¨æ‹é€†å¯Œå£«ï¼Œè¨˜å¾—æ—©ç¡ã€‚", place:"THE NOBORISAKA HOTEL" },
      ]
    },
    {
      id: "2026-02-23",
      dateLabel: "2/23ï¼ˆä¸€ï¼‰",
      title: "é€†å¯Œå£«ã€å¾¡æ®¿å ´è³¼ç‰©èˆ‡å¤œå·´",
      subtitle: "æ¸…æ™¨é€†å¯Œå£« â†’ å¿é‡å…«æµ· â†’ Outlet â†’ å¤œå·´å»ä»™å°",
      tags: ["spot","shop","transit","food"],
      items: [
        { time:"06:00", type:"spot", title:"ç”¢å±‹ãƒ¶å´ï¼ˆé€†å¯Œå£«æœ€ä½³æ™‚æ©Ÿï¼‰", note:"çœ‹å¤©æ°£èˆ‡é¢¨ï¼Œæ¹–é¢è¶Šå¹³è¶Šå®¹æ˜“å‡ºç¾å€’å½±ã€‚", place:"ç”£å±‹ãƒ¶å´" },
        { time:"09:00", type:"spot", title:"å¿é‡å…«æµ· æ•£ç­–", note:"æ°´å¾ˆæ¸…ã€æ‹ç…§å¾ˆä»™ï¼Œæ³¨æ„äººæ½®ã€‚", place:"å¿é‡å…«æµ·" },
        { time:"11:30", type:"shrine", title:"å¯ŒçŸ¥å…­æ‰€æµ…é–“ç¥ç¤¾", note:"ç¥ç¤¾æ°›åœå¾ˆæ£’ï¼Œåœç•™ä¸éœ€å¤ªä¹…ã€‚", place:"å¯ŒçŸ¥å…­æ‰€æµ…é–“ç¥ç¤¾" },
        { time:"13:30", type:"shop", title:"å¾¡æ®¿å ´ Outlet è³¼ç‰©ï¼ˆé‡é»ï¼šMOUSSY / SLYï¼‰", note:"å…ˆé–å®šç›®æ¨™åº—ï¼Œçœæ™‚é–“ä¹Ÿçœè…³ã€‚", place:"å¾¡æ®¿å ´ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ»ã‚¢ã‚¦ãƒˆãƒ¬ãƒƒãƒˆ" },
        { time:"18:00", type:"transit", title:"è¿”å›æ±äº¬å¸‚å€é‚„è»Š", note:"é ç•™å¡è»Šæ™‚é–“ï¼Œé¿å…å»¶èª¤æ™šé¤/å¤œå·´ã€‚", place:"æ±äº¬" },
        { time:"19:30", type:"food", title:"æ™šé¤ï¼šMichishirube", note:"å›åˆ°å¸‚å€è£œå……é«”åŠ›ã€‚", place:"Michishirube" },
        { time:"23:00", type:"transit", title:"å¤œé–“å·´å£«ï¼šæ±äº¬ â†’ ä»™å°", note:"å»ºè­°å¸¶é ¸æ•/çœ¼ç½©/è€³å¡ï¼Œæå‡ç¡çœ å“è³ªã€‚", place:"Tokyo Station" },
      ]
    },
    {
      id: "2026-02-24",
      dateLabel: "2/24ï¼ˆäºŒï¼‰",
      title: "è—ç‹å†°æ¨¹èˆ‡éŠ€å±±æº«æ³‰å¤¢å¹»ä¹‹å¤œ",
      subtitle: "æ¸…æ™¨åˆ°ä»™å°å–è»Š â†’ è—ç‹çºœè»Š â†’ éŠ€å±±æº«æ³‰å…¥ä½",
      tags: ["transit","spot","hotel"],
      items: [
        { time:"06:00", type:"transit", title:"æŠµé”ä»™å° & Toyota Rent a Car Sendai å–è»Š", note:"å…ˆè£œå……æ—©é¤/å’–å•¡ï¼Œä»Šå¤©æœƒå¾ˆå†·ã€‚", place:"Toyota Rent a Car ä»™å°" },
        { time:"08:00", type:"spot", title:"è—ç‹çºœè»Šï¼ˆå†°æ¨¹ï¼‰", note:"ä¿æš–è¦å¤ ï¼šæ‰‹å¥—/å¸½å­/æš–æš–åŒ…å¿…å‚™ã€‚", place:"Zao Ropeway" },
        { time:"15:30", type:"transit", title:"éŠ€å±±è˜ãƒ»å¤å‹¢èµ·å±‹åˆ¥é¤¨å®¿æ³Šè€…å°‚ç”¨é§è»Šå ´", note:"ä¾æ—…å®¿æŒ‡ç¤ºæ¥é§/æ­¥è¡Œå…¥å…§ã€‚", place:"éŠ€å±±è˜ãƒ»å¤å‹¢èµ·å±‹åˆ¥é¤¨å®¿æ³Šè€…å°‚ç”¨é§è»Šå ´" },
        { time:"â€”", type:"hotel", title:"ä½å®¿ï¼šå¤å‹¢èµ·å±‹åˆ¥é¤¨", note:"æ™šä¸Šæº«æ³‰è¡—ç‡ˆæ™¯è¶…å¤¢å¹»ï¼Œæ…¢æ…¢æ‹ã€‚", place:"å¤å‹¢èµ·å±‹åˆ¥é¤¨" },
      ]
    },
    {
      id: "2026-02-25",
      dateLabel: "2/25ï¼ˆä¸‰ï¼‰",
      title: "ç‹ç‹¸æ‘èˆ‡ä»™å°ç¾é£Ÿï¼Œæ·±å¤œå›æ±äº¬",
      subtitle: "ç‹ç‹¸æ‘ â†’ ä»™å°ç¥ç¤¾ â†’ ä¼´æ‰‹ç¦® â†’ æ–°å¹¹ç·šå›æ±äº¬",
      tags: ["spot","shrine","food","transit"],
      items: [
        { time:"10:00", type:"spot", title:"å‡ºç™¼ï¼šå®®åŸè—ç‹ç‹ç‹¸æ‘", note:"æ³¨æ„åœ’å€è¦ç¯„ï¼Œæ‹ç…§åˆ¥é©šæ“¾ç‹ç‹¸ã€‚", place:"å®®åŸè”µç‹ã‚­ãƒ„ãƒæ‘" },
        { time:"14:00", type:"shrine", title:"è¿”å›ä»™å°ï¼šåƒæ‹œ å¤§å´å…«å¹¡å®®", note:"å¾ˆæœ‰æ°£å‹¢çš„ç¥ç¤¾ï¼Œé©åˆæ”¶å¿ƒæ•£æ­¥ã€‚", place:"å¤§å´å…«å¹¡å®®" },
        { time:"16:00", type:"shop", title:"ä»™å°è»Šç«™ ä¼´æ‰‹ç¦®æ¡è²·", note:"ç‰›èˆŒç›¸é—œã€é»å¿ƒã€é™å®šå£å‘³ä¸€æ¬¡è£œé½Šã€‚", place:"ä»™å°é§…" },
        { time:"18:30", type:"food", title:"æ™šé¤ï¼šä»™å°è»Šç«™ç•¶åœ°ç¾é£Ÿï¼ˆç‰›èˆŒ/å£½å¸ï¼‰", note:"åƒé£½å†ä¸Šè»Šå›æ±äº¬æ›´èˆ’æœã€‚", place:"ä»™å°é§…" },
        { time:"21:00", type:"transit", title:"æ–°å¹¹ç·šï¼šä»™å° â†’ æ±äº¬", note:"å¯å…ˆæŠŠéš”å¤©æ±äº¬è¡Œç¨‹éœ€è¦çš„äº¤é€šç¥¨/è·¯ç·šç¢ºèªä¸€ä¸‹ã€‚", place:"ä»™å°é§…" },
        { time:"â€”", type:"hotel", title:"ä½å®¿ï¼šæ°‘å®¿", note:"åœ°å€ï¼š1 Chome-4 Minowa, Taito City, Tokyo 110-0011 æ—¥æœ¬", place:"1 Chome-4 Minowa, Taito City, Tokyo 110-0011 æ—¥æœ¬" },
      ]
    },
    {
      id: "2026-02-26",
      dateLabel: "2/26ï¼ˆå››ï¼‰",
      title: "æ±äº¬æ·±åº¦ç¾é£Ÿèˆ‡ç¥ç¤¾",
      subtitle: "å¯ºé™¢å·¡ç¦® â†’ æ’éšŠæ‹‰éºµ â†’ æ¼¢å ¡é»å¿ƒ â†’ å£½å–œç‡’æ™šé¤",
      tags: ["shrine","food"],
      items: [
        { time:"09:30", type:"shrine", title:"åƒæ‹œï¼šæ³•è¼ªå¯º", note:"ç¯€å¥æ”¾æ…¢ï¼Œæ‹ä¸€äº›æ—¥å¸¸æ„Ÿçš„æ±äº¬ã€‚", place:"æ³•è¼ªå¯º" },
        { time:"10:10", type:"shrine", title:"åƒæ‹œï¼šæ„Ÿé€šå¯º", note:"æ¥è‘—èµ°ç¬¬äºŒå€‹é»ï¼Œæ…¢æ…¢é€›ã€æ…¢æ…¢æ‹ã€‚", place:"æ„Ÿé€šå¯º" },
        { time:"11:30", type:"food", title:"åˆé¤ï¼šã‚‰ãéººã‚„å¶‹", note:"ç†±é–€åº—å¯èƒ½éœ€è¦æ’éšŠï¼Œæ—©åˆ°æ›´å¥½ã€‚", place:"ã‚‰ãéººã‚„ å¶‹" },
        { time:"14:30", type:"food", title:"é»å¿ƒï¼šShogun Burger", note:"æƒ³è¦çˆ½æ„Ÿå°±é»æ‹›ç‰Œã€‚", place:"Shogun Burger" },
        { time:"18:30", type:"food", title:"æ™šé¤ï¼šä¼Šå¹å£½å–œç‡’", note:"æš–èƒƒæ”¶å°¾ï¼Œä»Šå¤©åƒå¾—å¾ˆå®Œæ•´ã€‚", place:"ä¼Šå¹ ã™ãç„¼ã" },
        { time:"â€”", type:"hotel", title:"ä½å®¿ï¼šæ°‘å®¿", note:"åœ°å€ï¼š1 Chome-4 Minowa, Taito City, Tokyo 110-0011 æ—¥æœ¬", place:"1 Chome-4 Minowa, Taito City, Tokyo 110-0011 æ—¥æœ¬" },
      ]
    },
    {
      id: "2026-02-27",
      dateLabel: "2/27ï¼ˆäº”ï¼‰",
      title: "æ±äº¬è¿ªå£«å°¼æµ·æ´‹",
      subtitle: "ä¸€æ•´å¤©æ”¾é›» â†’ æ™šä¸Šç‡’è‚‰è£œè¡€",
      tags: ["spot","food"],
      items: [
        { time:"06:00", type:"spot", title:"æ±äº¬è¿ªå£«å°¼æµ·æ´‹ å…¨æ—¥éŠç©", note:"å»ºè­°å…¥åœ’å…ˆæ¶ç†±é–€è¨­æ–½/è¡¨æ¼”æ™‚æ®µã€‚", place:"Tokyo DisneySea" },
        { time:"20:30", type:"food", title:"æ™šé¤ï¼šç„¼è‚‰ãƒ›ãƒ«ãƒ¢ãƒ³é‡‘æ¨¹", note:"ç©å®Œåƒè‚‰è¶…å¹¸ç¦ã€‚", place:"ç„¼è‚‰ãƒ›ãƒ«ãƒ¢ãƒ³é‡‘æ¨¹" },
        { time:"â€”", type:"hotel", title:"ä½å®¿ï¼šæ°‘å®¿", note:"åœ°å€ï¼š1 Chome-4 Minowa, Taito City, Tokyo 110-0011 æ—¥æœ¬", place:"1 Chome-4 Minowa, Taito City, Tokyo 110-0011 æ—¥æœ¬" },
      ]
    },
    {
      id: "2026-02-28",
      dateLabel: "2/28ï¼ˆå…­ï¼‰",
      title: "é˜¿ä½è°·æ¸…æ–°æ•£ç­–",
      subtitle: "ç¥ç¤¾æ•£æ­¥ â†’ ç‚¸è±¬æ’ååº— â†’ æ™šé¤æ”¶å°¾",
      tags: ["shrine","food"],
      items: [
        { time:"10:30", type:"shrine", title:"é˜¿ä½è°·ç¥æ˜å®®", note:"æ°£æ°›å¾ˆèˆ’æœï¼Œé©åˆæ‹æ¸…æ–°æ—¥ç³»æ„Ÿã€‚", place:"é˜¿ä½è°·ç¥æ˜å®®" },
        { time:"12:30", type:"food", title:"åˆé¤ï¼šTonkatsu Narikura", note:"ååº—è«‹é ç•™æ’éšŠ/é ç´„å¯èƒ½ã€‚", place:"ã¨ã‚“ã‹ã¤ æˆè”µ" },
        { time:"18:30", type:"food", title:"æ™šé¤ï¼šHiyoku no Tori", note:"ç”¨æº«æŸ”çš„ä¸€é¤æ”¶å°¾ä»Šå¤©ã€‚", place:"Hiyoku no Tori" },
        { time:"â€”", type:"hotel", title:"ä½å®¿ï¼šUeno First City Hotel", note:"å›ä¸Šé‡ä¼‘æ¯ï¼Œéš”å¤©æ”¶å°¾æ›´é †ã€‚", place:"Ueno First City Hotel" },
      ]
    },
    {
      id: "2026-03-01",
      dateLabel: "3/1ï¼ˆæ—¥ï¼‰",
      title: "éŠ€åº§åˆé¤å¾Œå‰å¾€æ©Ÿå ´",
      subtitle: "æœ€å¾Œä¸€é¤ç‡’è‚‰ â†’ å‡ºç™¼æ©Ÿå ´",
      tags: ["food","transit"],
      items: [
        { time:"11:00", type:"food", title:"åˆé¤ï¼šç‡’è‚‰ INOUE éŠ€åº§åº—", note:"æœ€å¾Œä¸€é¤åƒå¥½åƒæ»¿ï¼Œæ‹å¼µåˆç…§æ”¶å·¥ã€‚", place:"ç„¼è‚‰ INOUE éŠ€åº§åº—" },
        { time:"13:00", type:"transit", title:"çµæŸè¡Œç¨‹ï¼Œå‡ºç™¼å‰å¾€æ©Ÿå ´", note:"å»ºè­°ææ—©å‡ºç™¼ï¼Œä¿ç•™é€€ç¨…/è²·ä¼´æ‰‹ç¦®æ™‚é–“ã€‚", place:"æˆç”°æ©Ÿå ´" },
      ]
    }
  ];

  const STORAGE_KEY = "trip_checklist_v1";
  const THEME_KEY = "trip_theme_v1";
  const state = {
    done: new Set(JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]")),
    openAll: false
  };

  function itemKey(dayId, idx){ return `${dayId}__${idx}`; }

  function updateDayCardState(card, day){
    const total = day.items.length;
    const doneCount = day.items.reduce((n, _, idx) => n + (state.done.has(itemKey(day.id, idx)) ? 1 : 0), 0);
    card.dataset.done = (total > 0 && doneCount === total) ? "true" : "false";
  }

  function saveDone(){
    localStorage.setItem(STORAGE_KEY, JSON.stringify([...state.done]));
    renderProgress();
  }

  function toast(msg){
    const el = document.getElementById("toast");
    el.textContent = msg;
    el.classList.add("show");
    clearTimeout(window.__t);
    window.__t = setTimeout(()=> el.classList.remove("show"), 1400);
  }

  const typeLabel = {
    food:"é¤å»³/ç”œé»",
    shrine:"ç¥ç¤¾/å¯ºé™¢",
    hotel:"ä½å®¿",
    transit:"äº¤é€š/ç§Ÿè»Š",
    spot:"æ™¯é»/æ‹ç…§",
    shop:"è³¼ç‰©"
  };

  function dayTags(day){
    const s = new Set(day.tags || []);
    day.items.forEach(i => s.add(i.type));
    return [...s].filter(x => typeLabel[x]);
  }

  function makeMapUrl(place){
    const q = encodeURIComponent(place);
    return `https://www.google.com/maps/search/?api=1&query=${q}`;
  }

  const grid = document.getElementById("grid");
  const qEl = document.getElementById("q");
  const filterEl = document.getElementById("filter");

  function matchesQuery(day, query){
    if(!query) return true;
    const t = query.toLowerCase();
    const hay = [
      day.dateLabel, day.title, day.subtitle,
      ...day.items.flatMap(i => [i.time, i.title, i.note, i.place])
    ].join(" ").toLowerCase();
    return hay.includes(t);
  }

  function matchesFilter(day, filter){
    if(filter === "all") return true;
    if(filter === "todo"){
      return day.items.some((_, idx) => !state.done.has(itemKey(day.id, idx)));
    }
    return day.items.some(i => i.type === filter);
  }

  function render(){
    const query = qEl.value.trim();
    const filter = filterEl.value;

    grid.innerHTML = "";

    const days = itinerary
      .filter(d => matchesQuery(d, query))
      .filter(d => matchesFilter(d, filter));

    days.forEach((day) => {
      const card = document.createElement("section");
      card.className = "dayCard";
      card.dataset.open = state.openAll ? "true" : "false";
      updateDayCardState(card, day);

      const head = document.createElement("div");
      head.className = "dayHead";
      head.innerHTML = `
        <div class="dayTitle">
          <div class="date">
            <span class="tag drive">${day.dateLabel}</span>
            ${dayTags(day).map(t => `<span class="tag ${t}">${typeLabel[t]}</span>`).join("")}
          </div>
          <h2 title="${escapeHtml(day.title)}">${escapeHtml(day.title)}</h2>
          <p>${escapeHtml(day.subtitle)}</p>
        </div>
        <div class="chev" aria-hidden="true">â–¾</div>
      `;

      head.addEventListener("click", () => {
        const open = card.dataset.open === "true";
        card.dataset.open = open ? "false" : "true";
      });

      const body = document.createElement("div");
      body.className = "dayBody";

      const itemsWrap = document.createElement("div");
      itemsWrap.className = "items";

      day.items.forEach((it, idx) => {
        const key = itemKey(day.id, idx);
        const done = state.done.has(key);

        const row = document.createElement("div");
        row.className = "item" + (done ? " done" : "");
        row.dataset.type = it.type;

        if(filter !== "all" && filter !== "todo" && it.type !== filter){
          row.style.display = "none";
        }

        row.innerHTML = `
          <div class="time">${escapeHtml(it.time || "â€”")}</div>
          <div class="main">
            <p class="what"><strong>${escapeHtml(it.title)}</strong></p>
            <p class="note">${escapeHtml(it.note || "")}</p>
          </div>
          <div class="actions">
            <button class="mini" data-map>ğŸ—ºï¸ åœ°åœ–</button>
            <label class="check" title="å‹¾é¸å®Œæˆï¼ˆæœƒè‡ªå‹•ä¿å­˜ï¼‰">
              <input type="checkbox" ${done ? "checked":""} />
              å®Œæˆ
            </label>
          </div>
        `;

        row.querySelector('[data-map]').addEventListener("click", (e) => {
          e.stopPropagation();
          window.open(makeMapUrl(it.place || it.title), "_blank");
        });

        row.querySelector('input[type="checkbox"]').addEventListener("change", (e) => {
          if(e.target.checked){
            state.done.add(key);
            row.classList.add("done");
            toast("å·²å®Œæˆ âœ…");
          } else {
            state.done.delete(key);
            row.classList.remove("done");
            toast("å·²å–æ¶ˆå‹¾é¸ â†©ï¸");
          }
          saveDone();
          updateDayCardState(card, day);
          if(filterEl.value === "todo") render();
        });

        itemsWrap.appendChild(row);
      });

      body.appendChild(itemsWrap);
      card.appendChild(head);
      card.appendChild(body);
      grid.appendChild(card);
    });

    renderProgress();
  }

  function renderProgress(){
    const total = itinerary.reduce((sum, d) => sum + d.items.length, 0);
    const done = state.done.size;
    const pct = total ? Math.round((done / total) * 100) : 0;

    document.getElementById("totalText").textContent = total;
    document.getElementById("doneText").textContent = done;
    document.getElementById("pctText").textContent = pct + "%";
    document.getElementById("barFill").style.width = pct + "%";
  }

  qEl.addEventListener("input", () => render());
  filterEl.addEventListener("change", () => render());

  document.getElementById("expandAll").addEventListener("click", () => {
    state.openAll = !state.openAll;
    document.getElementById("expandAll").textContent = state.openAll ? "ğŸ§¾ å…¨éƒ¨æ”¶åˆ" : "ğŸ§¾ å…¨éƒ¨å±•é–‹";
    document.querySelectorAll(".dayCard").forEach(c => c.dataset.open = state.openAll ? "true" : "false");
  });

  document.getElementById("reset").addEventListener("click", () => {
    const ok = confirm("ç¢ºå®šè¦æ¸…ç©ºæ‰€æœ‰å‹¾é¸å—ï¼Ÿï¼ˆä¸å¯å¾©åŸï¼‰");
    if(!ok) return;
    state.done.clear();
    saveDone();
    toast("å·²æ¸…ç©º ğŸ§¼");
    render();
  });

  function applyTheme(t){
    document.documentElement.setAttribute("data-theme", t);
    localStorage.setItem(THEME_KEY, t);
  }
  const savedTheme = localStorage.getItem(THEME_KEY);
  if(savedTheme) applyTheme(savedTheme);

  document.getElementById("toggleTheme").addEventListener("click", () => {
    const cur = document.documentElement.getAttribute("data-theme") || "dark";
    applyTheme(cur === "dark" ? "light" : "dark");
  });

  function escapeHtml(s){
    return String(s ?? "")
      .replaceAll("&","&amp;")
      .replaceAll("<","&lt;")
      .replaceAll(">","&gt;")
      .replaceAll('"',"&quot;")
      .replaceAll("'","&#039;");
  }

  render();
</script>
</body>
</html>







